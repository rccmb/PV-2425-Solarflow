@model List<SolarflowClient.Models.ViewModels.Notifications.GetNotificationsViewModel>
@{
    ViewData["Title"] = "Notifications Page";
}

<link href="~/css/notifications/notifications.css" rel="stylesheet" asp-append-version="true" />


<h1 class="page-title mb-4">📬 Notifications</h1>

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}

@if (!Model.Any())
{
    <div class="alert alert-info">
        You have no notifications.
    </div>
}
else
{
    <form method="post" asp-action="DeleteAll">
        <button type="submit" class="btn btn-outline-danger mb-3 float-end">
            🗑️ Delete All
        </button>
    </form>

    <div class="table-responsive">
        <table class="table table-hover align-middle shadow-sm rounded bg-white">
            <thead class="table-light">
                <tr>
                    <th style="width: 15%">Title</th>
                    <th style="width: 40%">Description</th>
                    <th style="width: 15%">Sent</th>
                    <th style="width: 10%">Status</th>
                    <th style="width: 20%">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var notification in Model)
                {
                    var isUnread = notification.Status == "Unread";
                    <tr class="@(isUnread ? "table-warning" : "table-light")">
                        <td class="fw-bold">@notification.Title</td>
                        <td>@notification.Description</td>
                        <td>@notification.TimeSent.ToLocalTime().ToString("g")</td>
                        <td>
                            <span class="badge bg-@(isUnread ? "warning text-dark" : "success")">
                                @notification.Status
                            </span>
                        </td>
                        <td>
                        <div class="actions flex-column align-items-end">
                                @if (isUnread)
                                {
                                    <form method="post" asp-action="MarkAsRead" asp-route-id="@notification.Id">
                                        <button type="submit" class="btn btn-success" title="Mark as Read">
                                            ✔ Mark as Read
                                        </button>
                                    </form>
                                }
                                <form method="post" asp-action="Delete" asp-route-id="@notification.Id">
                                    <button type="submit" class="btn btn-danger" title="Delete">
                                        🗑️ Delete
                                    </button>
                                </form>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
